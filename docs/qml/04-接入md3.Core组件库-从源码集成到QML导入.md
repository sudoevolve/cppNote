# 04-接入 md3.Core 组件库：从源码集成到 QML import

目录页：见 [QML 教程目录](00-目录.md)

## 目标

- 了解 `material-components-qml` 提供了什么：MD3 组件 + Theme + 动态配色
- 学会把 `md3.Core` 以“源码集成”的方式接入你的 Qt Quick 工程
- 在 QML 里用 `import md3.Core` 开始写组件化 UI（不依赖 QtQuick.Controls）

## 先决知识（建议）

- 能创建并运行一个 Qt Quick 工程（见 QML 01 章）
- 会写基础 QML（见 QML 02 章）

---

## 1. 你接入的是什么：md3.Core（核心库）

`material-components-qml` 的核心模块是：
- `md3.Core`：组件 + 主题系统（Theme） + C++ 后端（md3Core）

你可以把它理解成：
- 一套“可复用的 UI 零件箱”（Button、IconButton、Card、Dialog、Ripple…）
- 一套“全局主题与动态配色系统”（颜色、排版、形状）

---

## 2. 前置要求（按工程实践）

这个库面向 Qt 6，建议你满足：
- Qt 6.8 或更高
- CMake 3.16+
- C++ 编译器支持 C++17+

---

## 3. 推荐接入方式：源码集成（vendor）

最稳妥的方式是把 md3 当成源码依赖一起编译（而不是手动拷贝 QML 文件）。

你可以把仓库放到你的工程里，比如：

```
your-app/
  CMakeLists.txt
  src/
  third_party/
    md3/   (material-components-qml)
```

然后在你的 `CMakeLists.txt` 里把 md3 Core 加进来（示意）：

```cmake
set(MD3_SOURCE_DIR "${CMAKE_CURRENT_SOURCE_DIR}/third_party/md3")

add_subdirectory("${MD3_SOURCE_DIR}/src/Core" md3Core_build)

target_link_libraries(your_app
    PRIVATE
        Qt6::Quick
        md3Core
)
```

核心直觉：
- `add_subdirectory(...)`：把 md3Core 当成你工程的一部分一起构建
- `target_link_libraries(...)`：你的 app 链接 md3Core（让 QML 模块与 C++ 后端可用）

---

## 4. 在 QML 里使用：import md3.Core

接入成功后，你就能在 QML 里写：

```qml
import QtQuick
import QtQuick.Window
import md3.Core

Window {
    width: 800
    height: 600
    visible: true
    color: Theme.color.background

    Button {
        text: "Hello MD3"
        anchors.centerIn: parent
    }
}
```

注意：
- 这类组件来自 `md3.Core`，不是 `QtQuick.Controls`
- 你的工程仍然保持“禁止 Controls”的约束

---

## 5. 动态配色：从 seed color 生成整套主题（直觉）

MD3 很重要的一个点是“动态配色”：
- 你提供一个 seed color
- 系统生成一套配色角色（primary/onPrimary/surface/background…）

在工程实践里，你可以把它用在：
- 做“主题设置页”：用户选一个主色，整个应用风格都跟着变
- 做“壁纸取色模拟”：用图片主色作为 seed

---

## 6. 什么时候不建议立刻接入 md3.Core

如果你还在练 QML 基础（布局、绑定、状态），可以先不接入：
- 先用 Rectangle/Text/MouseArea 写出最小组件
- 等你明确需要“主题系统 + 一套成熟组件”再接入

但如果你目标是做桌面应用 UI、追求一致性与开发效率：
- 接入 md3.Core 会让你少造很多轮子（按钮/对话框/导航/反馈组件）

---

## 常见坑

- 错误：只拷贝了 QML 文件，没有把 C++ 后端一起构建  
  结果：import 失败或 Theme/组件功能不完整  
  正确：按“源码集成”方式把 `src/Core` 加进 CMake

- 错误：以为用了 md3.Core 就可以随便 import QtQuick.Controls  
  结果：教程约束被破坏、组件风格混杂  
  正确：坚持只用 QtQuick 基础元素 + md3.Core

---

## 小练习

### 练习 1：把 QML 02 的示例替换成 md3.Core 的 Button

- 题目：把你之前用 Rectangle 拼的“按钮”替换成 md3 的 Button
- 约束：禁止 QtQuick.Controls
- 目标：体验“组件库带来的开发效率”

### 练习 2：做一个最小主题页

- 题目：做一个页面，能切换 2 套 seed color（比如 purple/blue）
- 约束：禁止 QtQuick.Controls
- 目标：体验“动态配色”的价值

---

## 小结

- md3.Core 提供：MD3 组件 + Theme 系统 + 动态配色
- 推荐接入方式：源码集成（add_subdirectory + link md3Core）
- QML 使用方式：`import md3.Core`，不需要 QtQuick.Controls

